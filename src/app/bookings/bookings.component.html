<div class="container my-5">
    <!-- Section Title -->
    <h2 class="text-center mb-5 text-dark display-4 fw-bold">
        <i class="fas fa-calendar-alt me-3"></i>Bookings for User ID: {{ userId }}
    </h2>

    <div class="row">
        <!-- Sidebar Navigation -->
        <div class="col-md-3">
            <nav class="nav flex-column bg-light p-3 rounded shadow-sm">
                <a 
                    class="nav-link text-dark py-2" 
                    [ngClass]="{ 'active fw-bold text-primary': selectedStatus === 'Pending' }" 
                    (click)="filterBookings('Pending')"
                >
                    <i class="fas fa-exclamation-circle me-2"></i> Pending Bookings
                </a>
                <a 
                    class="nav-link text-dark py-2" 
                    [ngClass]="{ 'active fw-bold text-primary': selectedStatus === 'Booked' }" 
                    (click)="filterBookings('Booked')"
                >
                    <i class="fas fa-check-circle me-2"></i> Verified Bookings
                </a>
                <a 
                    class="nav-link text-dark py-2" 
                    [ngClass]="{ 'active fw-bold text-primary': selectedStatus === 'Complete' }" 
                    (click)="filterBookings('Complete')"
                >
                    <i class="fas fa-history me-2"></i> Past Bookings
                </a>
                <a 
                    class="nav-link text-dark py-2" 
                    [ngClass]="{ 'active fw-bold text-primary': selectedStatus === 'Canceled' }" 
                    (click)="filterBookings('Canceled')"
                >
                    <i class="fas fa-ban me-2"></i> Canceled Bookings
                </a>
            </nav>
        </div>

        <!-- Booking List Section -->
        <div class="col-md-9">
            <div *ngIf="filteredBookings.length > 0; else noBookings" @fadeAnimation>
                <div class="row">
                    <div *ngFor="let booking of filteredBookings; let i = index" class="col-12 col-md-6 mb-4">
                        <div class="card border-0 shadow-lg rounded-4">
                            <div class="card-body">
                                <!-- Guest Information -->
                                <h5 class="card-title text-primary d-flex align-items-center mb-3">
                                    <i class="fas fa-user me-3 text-muted"></i>{{ booking.guestName }}
                                </h5>
                                <p class="card-subtitle text-muted mb-4">
                                    <i class="fas fa-bed me-2 text-warning"></i>{{ booking.accommodationType }}
                                </p>
            
                                <!-- Booking Details -->
                                <ul class="list-unstyled">
                                    <li class="mb-3 d-flex align-items-center">
                                        <i class="fas fa-users text-secondary me-3"></i>
                                        <strong>Guests:</strong>
                                        <span class="ms-auto text-dark">{{ booking.numberOfGuests }}</span>
                                    </li>
                                    <li class="mb-3 d-flex align-items-center">
                                        <i class="fas fa-calendar-check text-success me-3"></i>
                                        <strong>Check-In:</strong>
                                        <span class="ms-auto text-dark">{{ booking.checkInDate | date:'mediumDate' }}</span>
                                    </li>
                                    <li class="mb-3 d-flex align-items-center">
                                        <i class="fas fa-calendar-times text-danger me-3"></i>
                                        <strong>Check-Out:</strong>
                                        <span class="ms-auto text-dark">{{ booking.checkOutDate | date:'mediumDate' }}</span>
                                    </li>
                                    <li class="mb-3 d-flex align-items-center">
                                        <i class="fas fa-info-circle text-info me-3"></i>
                                        <strong>Status:</strong>
                                        <span class="ms-auto">
                                            <span class="badge rounded-pill" [ngClass]="{
                                                'bg-success': booking.bookingStatus === 'Booked',
                                                'bg-warning': booking.bookingStatus === 'Pending',
                                                'bg-secondary': booking.bookingStatus === 'Complete',
                                                'bg-danger': booking.bookingStatus === 'Canceled by Traveller' || booking.bookingStatus === 'Canceled by Provider',
                                                'bg-primary': booking.bookingStatus === 'Waiting for payment'
                                            }">
                                                 {{ booking.bookingStatus === 'Pending' ? 'Waiting for Verification' : booking.bookingStatus }}
                                            </span>
                                            <!-- <span class="badge rounded-pill" [ngClass]="{
                                                'bg-success': booking.bookingStatus === 'Booked',
                                                'bg-warning': booking.bookingStatus === 'CheckedIn',
                                                'bg-secondary': booking.bookingStatus === 'CheckedOut',
                                                'bg-warning': booking.bookingStatus === 'Pending' || booking.bookingStatus === 'Waiting for payment',

                                                'bg-danger': booking.bookingStatus === 'Canceled'
                                            }">
                                                {{ booking.bookingStatus }}
                                            </span> -->
                                        </span>
                                    </li>
                                </ul>
                            </div>
                            <!-- Card Footer -->
                            <div class="card-footer text-center bg-light">
                                <button class="btn btn-outline-secondary btn-sm px-3 py-1" (click)="openBookingModal(i)">
                                    Details
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            

            <!-- No Bookings Message -->
            <ng-template #noBookings>
                <div class="alert alert-warning text-center mt-4">
                    <strong>No bookings available for this category.</strong>
                </div>
            </ng-template>
        </div>
    </div>




<!-- Bootstrap Modal for Booking Details -->
<div #bookingModal class="modal fade" tabindex="-1" aria-labelledby="bookingModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow-lg rounded-3">
            <!-- Modal Header -->
            <div class="modal-header bg-dark text-white border-0">
                <h5 class="modal-title d-flex align-items-center" id="bookingModalLabel">
                    <i class="fas fa-calendar-check me-3"></i>Booking Details
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <!-- Modal Body -->
            <div class="modal-body">
                <div class="list-group list-group-flush">
                    <!-- Guest Name -->
                    <div class="list-group-item d-flex align-items-center border-0 py-3">
                        <i class="fas fa-user me-3 text-muted"></i>
                        <strong class="text-muted">Guest Name:</strong>
                        <span class="ms-auto text-dark">{{ selectedBooking?.guestName }}</span>
                    </div>
                    <!-- Accommodation Type -->
                    <div class="list-group-item d-flex align-items-center border-0 py-3">
                        <i class="fas fa-bed me-3 text-muted"></i>
                        <strong class="text-muted">Accommodation Type:</strong>
                        <span class="ms-auto text-dark">{{ selectedBooking?.accommodationType }}</span>
                    </div>
                    <!-- Number of Guests -->
                    <div class="list-group-item d-flex align-items-center border-0 py-3">
                        <i class="fas fa-users me-3 text-muted"></i>
                        <strong class="text-muted">Number of Guests:</strong>
                        <span class="ms-auto text-dark">{{ selectedBooking?.numberOfGuests }}</span>
                    </div>
                    <!-- Check-In Date -->
                    <div class="list-group-item d-flex align-items-center border-0 py-3">
                        <i class="fas fa-calendar-check me-3 text-muted"></i>
                        <strong class="text-muted">Check-In Date:</strong>
                        <span class="ms-auto text-dark">{{ selectedBooking?.checkInDate | date:'mediumDate' }}</span>
                    </div>
                    <!-- Check-Out Date -->
                    <div class="list-group-item d-flex align-items-center border-0 py-3">
                        <i class="fas fa-calendar-times me-3 text-muted"></i>
                        <strong class="text-muted">Check-Out Date:</strong>
                        <span class="ms-auto text-dark">{{ selectedBooking?.checkOutDate | date:'mediumDate' }}</span>
                    </div>
                    <!-- Booking Status -->
                    <div class="list-group-item d-flex align-items-center border-0 py-3">
                        <i class="fas fa-info-circle me-3 text-muted"></i>
                        <strong class="text-muted">Status:</strong>
                        <span class="ms-auto">
                            <span class="badge rounded-pill" [ngClass]="{
                                'bg-success': selectedBooking?.bookingStatus === 'Booked',
                                'bg-danger': selectedBooking?.bookingStatus === 'Canceled by Traveller' || selectedBooking?.bookingStatus === 'Canceled by Provider',
                                'bg-primary': selectedBooking?.bookingStatus === 'Waiting for payment', 
                                'bg-warning': selectedBooking?.bookingStatus === 'Pending',
                                'bg-secondary': selectedBooking?.bookingStatus === 'Complete'
                            }">
                                {{ selectedBooking?.bookingStatus === 'Pending' ? 'Waiting for Verification' : selectedBooking?.bookingStatus }}
                            </span>
                            
                            <!-- <span class="badge rounded-pill" [ngClass]="{
                                'bg-success': selectedBooking?.bookingStatus === 'Booked',
                                'bg-warning': selectedBooking?.bookingStatus === 'CheckedIn',
                                'bg-secondary': selectedBooking?.bookingStatus === 'CheckedOut',
                                'bg-danger': selectedBooking?.bookingStatus === 'Cancelled'
                            }">
                                {{ selectedBooking?.bookingStatus }}
                            </span> -->
                        </span>
                    </div>
                    <!-- Special Requests -->
                    <div class="list-group-item d-flex align-items-center border-0 py-3">
                        <i class="fas fa-comment-alt me-3 text-muted"></i>
                        <strong class="text-muted">Special Requests:</strong>
                        <span class="ms-auto text-dark">{{ selectedBooking?.specialRequest || 'None' }}</span>
                    </div>
                </div>
            </div>

<!-- Modal Footer -->
<div class="modal-footer border-0">
    <button type="button" class="btn btn-outline-secondary btn-sm" data-bs-dismiss="modal">
      <i class="fas fa-times-circle me-2"></i>Close
    </button>
  
    <!-- Conditionally Rendered Buttons for 'Waiting for payment' and 'Pending' Status -->
    <ng-container *ngIf="selectedBooking?.bookingStatus === 'Waiting for payment'">
      <button 
        type="button" 
        class="btn btn-outline-success btn-sm" 
        (click)="payForBooking(selectedBooking._id, selectedBooking.amount, 'Accommodation')">
        <i class="fas fa-check-circle me-2"></i>Pay Now
      </button>
    </ng-container>
  
    <ng-container *ngIf="['Pending', 'Waiting for payment'].includes(selectedBooking?.bookingStatus)">
      <button 
        type="button" 
        class="btn btn-outline-danger btn-sm" 
        (click)="cancelBooking(selectedBooking)">
        <i class="fas fa-times-circle me-2"></i>Cancel Booking
      </button>
    </ng-container>
  </div>
  

        </div>
    </div>
</div>


</div>
