<app-user-navbar></app-user-navbar>
<app-search></app-search>

<div class="container my-5">
  <h2 class="text-center mb-5">Accommodation Services</h2>

  <div *ngIf="accommodationServices.length === 0" class="text-center text-muted">
    <p>No accommodation services found.</p>
  </div>

  <div *ngIf="accommodationServices.length > 0" class="row">
    <div
      *ngFor="let service of accommodationServices"
      class="col-md-6 col-lg-4 mb-4"
      (click)="goToDetail(service._id)"
    >
      <div class="card h-100 shadow-sm hover-shadow">
        <div *ngIf="service.productImages?.length">
          <img
            [src]="'http://localhost:3000/' + service.productImages[0]"
            alt="{{ service.productName }}"
            class="card-img-top img-fluid"
            style="height: 300px; object-fit: cover;"
          />
        </div>
        <div class="card-body">
          <h3 class="card-title">{{ service.productName }}</h3>
          <p class="card-text">{{ service.productDescription }}</p>
          <p><strong>Location:</strong> {{ service.location }}</p>
          <div class="rating">
            <ng-container *ngIf="service.averageRating > 0; else noRating">
              <!-- Full Stars -->
              <i *ngFor="let _ of [].constructor(Math.floor(service.averageRating))" class="fas fa-star star"></i>
          
              <!-- Half Star (only one if rating has a half part) -->
              <i *ngIf="service.averageRating % 1 >= 0.5" class="fas fa-star-half-alt star"></i>
          
              <!-- Empty Stars (always ensures 5 stars are displayed) -->
              <i *ngFor="let _ of [].constructor(5 - Math.floor(service.averageRating) - (service.averageRating % 1 >= 0.5 ? 1 : 0))" class="far fa-star star"></i>
          
              <!-- Display Average Rating and Review Count in Format "4.3 (15)" -->
              <span>{{ service.averageRating | number: '1.1-1' }} ({{ service.reviewCount }})</span>
            </ng-container>
          
            <!-- Fallback message if there is no rating -->
            <ng-template #noRating>
              <span class="text-muted">No ratings yet</span>
            </ng-template>
          </div>
          
          
        </div>
      </div>
    </div>
  </div>
</div>