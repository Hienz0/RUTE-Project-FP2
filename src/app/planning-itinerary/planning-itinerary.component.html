<app-user-navbar></app-user-navbar>
<div class="container my-5">
  <h1 class="text-center mb-4">{{ animatedText }}</h1>

  
    <!-- Vacation Date Form -->
<!-- Vacation Date Form -->
<form #itineraryForm="ngForm" (ngSubmit)="onSubmit()" class="itinerary-form mb-5">
  <div class="row g-4">
    <!-- Vacation Start Date -->
    <div class="col-md-6">
      <label for="vacationStartDate" class="form-label">Vacation Start Date</label>
      <input
        type="date"
        id="vacationStartDate"
        class="form-control"
        [(ngModel)]="vacationStartDate"
        name="vacationStartDate"
        (ngModelChange)="saveVacationDate()"
        required
      />
    </div>

    <!-- Vacation End Date -->
    <div class="col-md-6">
      <label for="vacationEndDate" class="form-label">Vacation End Date</label>
      <input
        type="date"
        id="vacationEndDate"
        class="form-control"
        [(ngModel)]="vacationEndDate"
        name="vacationEndDate"
        (ngModelChange)="saveVacationDate()"
        required
      />
    </div>
  </div>

  <!-- Buttons -->
  <div class="button-group d-flex justify-content-center mt-4 gap-3">
    <button
      type="submit"
      class="btn btn-primary btn-lg"
      [disabled]="!itineraryForm.valid"
    >
      <i class="bi bi-calendar2-check"></i> Plan Itinerary
    </button>
    <button
      type="button"
      class="btn btn-outline-dark btn-lg"
      (click)="clearFields(itineraryForm)"
    >
      <i class="bi bi-x-circle"></i> Clear All
    </button>
  </div>
</form>

  
  

<!-- Services Selection -->
<!-- Services Selection -->
<div *ngIf="showServiceSelection" class="container-fluid px-5">
  <h2 class="mb-3 text-center fs-5">
    <i class="fas fa-cogs text-primary"></i> Select Services
  </h2>
  <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-3">
    <div class="col" *ngFor="let service of availableServices">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title text-primary fs-6">
            <i class="fas fa-building"></i> {{ service.serviceName }}
          </h5>
          <h6 class="card-subtitle mb-2 text-muted fs-6">
            <i class="fas fa-info-circle"></i> {{ service.serviceType }}
          </h6>
          <div class="mb-3">
            <ng-container *ngIf="service.serviceType === 'Accommodation' || service.serviceType === 'Vehicle'">
              <!-- Date range and time -->
              <div class="mb-2">
                <h6 class="fw-bold fs-7">
                  <i class="fas fa-play"></i> Start
                </h6>
                <div class="row g-1">
                  <div class="col-6">
                    <label for="startDate-{{ service.serviceType }}" class="form-label fs-7">
                      <i class="fas fa-calendar-day"></i> Start Date
                    </label>
                    <input
                      type="date"
                      class="form-control form-control-sm"
                      style="font-size: 0.7rem; height: 1.4rem;"
                      [(ngModel)]="service.startDate"
                      name="startDate-{{ service.serviceType }}"
                      [min]="vacationStartDate"
                      [max]="vacationEndDate"
                      (ngModelChange)="saveServiceChange(service)"
                    />
                  </div>
                  <div class="col-6">
                    <label for="startTime-{{ service.serviceType }}" class="form-label fs-7">
                      <i class="fas fa-clock"></i> Start Time
                    </label>
                    <input
                      type="time"
                      class="form-control form-control-sm"
                      style="font-size: 0.7rem; height: 1.4rem;"
                      [(ngModel)]="service.startTime"
                      name="startTime-{{ service.serviceType }}"
                      (ngModelChange)="saveServiceChange(service)"
                    />
                  </div>
                </div>
              </div>
              <div class="mb-2">
                <h6 class="fw-bold fs-7">
                  <i class="fas fa-stop"></i> End
                </h6>
                <div class="row g-1">
                  <div class="col-6">
                    <label for="endDate-{{ service.serviceType }}" class="form-label fs-7">
                      <i class="fas fa-calendar-check"></i> End Date
                    </label>
                    <input
                      type="date"
                      class="form-control form-control-sm"
                      style="font-size: 0.7rem; height: 1.4rem;"
                      [(ngModel)]="service.endDate"
                      name="endDate-{{ service.serviceType }}"
                      [min]="service.startDate"
                      [max]="vacationEndDate"
                      (ngModelChange)="saveServiceChange(service)"
                    />
                  </div>
                  <div class="col-6">
                    <label for="endTime-{{ service.serviceType }}" class="form-label fs-7">
                      <i class="fas fa-clock"></i> End Time
                    </label>
                    <input
                      type="time"
                      class="form-control form-control-sm"
                      style="font-size: 0.7rem; height: 1.4rem;"
                      [(ngModel)]="service.endTime"
                      name="endTime-{{ service.serviceType }}"
                      (ngModelChange)="saveServiceChange(service)"
                    />
                  </div>
                </div>
              </div>
            </ng-container>

            <ng-container *ngIf="service.serviceType === 'Tour' || service.serviceType === 'Restaurant'">
              <!-- Single date and time -->
              <div class="mb-2">
                <label for="singleDate-{{ service.serviceType }}" class="form-label fs-7">
                  <i class="fas fa-calendar-day"></i> Date
                </label>
                <input
                  type="date"
                  class="form-control form-control-sm"
                  style="font-size: 0.7rem; height: 1.4rem;"
                  [(ngModel)]="service.singleDate"
                  name="singleDate-{{ service.serviceType }}"
                  [min]="vacationStartDate"
                  [max]="vacationEndDate"
                  (ngModelChange)="saveServiceChange(service)"
                />
              </div>
              <div class="mb-2">
                <label for="singleTime-{{ service.serviceType }}" class="form-label fs-7">
                  <i class="fas fa-clock"></i> Time
                </label>
                <input
                  type="time"
                  class="form-control form-control-sm"
                  style="font-size: 0.7rem; height: 1.4rem;"
                  [(ngModel)]="service.singleTime"
                  name="singleTime-{{ service.serviceType }}"
                  (ngModelChange)="saveServiceChange(service)"
                />
              </div>
            </ng-container>
          </div>

          <div class="d-flex flex-wrap gap-1">
            <button
              class="btn btn-outline-primary btn-sm"
              style="border-radius: 0.25rem; font-size: 0.75rem; padding: 0.2rem 0.5rem;"
              (click)="addService(service)"
              [disabled]="!isAddToItineraryEnabled(service)"

            >
              <i class="fas fa-plus"></i> Add
            </button>
            <button
              class="btn btn-outline-secondary btn-sm"
              style="border-radius: 0.25rem; font-size: 0.75rem; padding: 0.2rem 0.5rem;"
              (click)="chooseService(service)"
              [disabled]="isChooseDisabled(service)"
            >
              <i class="fas fa-check"></i> Choose
            </button>
            <button
              class="btn btn-outline-success btn-sm"
              style="border-radius: 0.25rem; font-size: 0.75rem; padding: 0.2rem 0.5rem;"
              (click)="viewItinerary(service)"
              [disabled]="!isBookingIdValid(service)"
            >
              <i class="fas fa-eye"></i> View
            </button>
            <button
              class="btn btn-outline-danger btn-sm"
              style="border-radius: 0.25rem; font-size: 0.75rem; padding: 0.2rem 0.5rem;"
              (click)="resetService(service)"
            >
              <i class="fas fa-undo"></i> Reset
            </button>
          </div>
          
        </div>
      </div>
    </div>
  </div>

  <!-- Clear Itinerary Button -->
  <div class="text-center mt-3">
    <button
      class="btn btn-danger btn-sm"
    >
      <i class="fas fa-trash-alt"></i> Clear Itinerary
    </button>
  </div>
</div>



  
    <!-- Selected Services Summary -->
    <div *ngIf="selectedServices.length > 0" class="mt-5">
      <!-- Section Header -->
      <h2 class="mb-4 text-center text-primary fw-bold">My Planned Itinerary</h2>
    
      <!-- Services List -->
      <div class="card shadow-lg p-3 mb-4 bg-light rounded">
        <ul class="list-group list-group-flush">
          <li *ngFor="let service of selectedServices" class="list-group-item d-flex align-items-center justify-content-between">
            <div>
              <h5 class="mb-1 text-dark">{{ service.serviceType }} - {{ service.serviceName }}</h5>
              <p class="mb-0 text-muted">
                <span *ngIf="service.startDate && service.endDate">
                  {{ service.startDate }} {{ service.startTime }} to {{ service.endDate }} {{ service.endTime }}
                </span>
                <span *ngIf="service.singleDate">
                  {{ service.singleDate }} {{ service.singleTime }}
                </span>
              </p>
            </div>
            <div>
              <button
                class="btn btn-outline-primary btn-sm me-2"
                (click)="viewItinerary(service)"
              >
                <i class="fas fa-eye"></i> View
              </button>
              <button
                class="btn btn-outline-danger btn-sm"
                (click)="removeService(service)"
              >
                <i class="fas fa-trash"></i> Remove
              </button>
            </div>
          </li>
        </ul>
      </div>
    
      <!-- Total Amount -->
      <div class="mt-4 text-end">
        <h4 class="text-success fw-bold">Total Amount: {{ totalAmount | currency }}</h4>
      </div>
    
      <!-- Clear & Confirm Buttons -->
      <div class="d-flex justify-content-between mt-4">
        <button class="btn btn-outline-warning px-4 py-2" (click)="clearAllServices()">
          <i class="fas fa-times"></i> Clear My Planning
        </button>
        <button class="btn btn-success px-4 py-2" (click)="confirmItinerary()">
          <i class="fas fa-check-circle"></i> Confirm Itinerary
        </button>
      </div>
    </div>
    
    
    


    <!-- Booking Details Modal -->
<div class="modal fade" id="bookingModal" tabindex="-1" aria-labelledby="bookingModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="bookingModalLabel">Booking Details</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <!-- Booking details content will be dynamically injected here -->
        <div *ngIf="bookingDetails">
          <div *ngIf="bookingDetails.serviceType === 'Accommodation'">
            <h5>{{ bookingDetails.accommodationName }}</h5>
            <p>Guest Name: {{ bookingDetails.guestName }}</p>
            <p>Accommodation Type: {{ bookingDetails.accommodationType }}</p>
            <p>Number of Guests: {{ bookingDetails.numberOfGuests }}</p>
            <p>Check-In Date: {{ bookingDetails.checkInDate | date }}</p>
            <p>Check-Out Date: {{ bookingDetails.checkOutDate | date }}</p>
            <p>Special Request: {{ bookingDetails.specialRequest }}</p>
            <p>Status: {{ bookingDetails.bookingStatus }}</p>
          </div>
          
          <div *ngIf="bookingDetails.serviceType === 'Tour'">
            <h5>{{ bookingDetails.tourName }}</h5>
            <p>Customer Name: {{ bookingDetails.customerName }}</p>
            <p>Tour Guide: {{ bookingDetails.tourguideType }}</p>
            <p>Tour Date: {{ bookingDetails.tourDate | date }}</p>
            <p>Pickup Location: {{ bookingDetails.pickupLocation }}</p>
            <p>Number of Participants: {{ bookingDetails.numberOfParticipants }}</p>
            <p>Status: {{ bookingDetails.bookingStatus }}</p>
          </div>
          
          <div *ngIf="bookingDetails.serviceType === 'Vehicle'">
            <h5>{{ bookingDetails.productName }}</h5>
            <p>Customer Name: {{ bookingDetails.customerName }}</p>
            <p>Pickup Location: {{ bookingDetails.vehiclePickupLocation }}</p>
            <p>Dropoff Location: {{ bookingDetails.vehicleDropoffLocation }}</p>
            <p>Rental Duration: {{ bookingDetails.rentalDuration }} hours</p>
            <p>Status: {{ bookingDetails.bookingStatus }}</p>
          </div>

          <div *ngIf="bookingDetails.serviceType === 'Restaurant'">
            <h5>{{ bookingDetails.productName }}</h5>
            <p>Status: {{ bookingDetails.bookingStatus }}</p>
            <p>Booking Date: {{ bookingDetails.bookingDate | date }}</p>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="closeModal()">Close</button>
      </div>
    </div>
  </div>
</div>

  </div>

  
  