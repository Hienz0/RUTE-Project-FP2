<app-search></app-search>

<div class="container mt-5">
    <div class="row">
      <div *ngFor="let service of services" class="col-md-4 mb-4">
        <div class="card h-100" (click)="navigateToDetails(service.serviceId)" style="cursor: pointer">
          <!-- Bootstrap Carousel for displaying images -->
          <div
            id="carousel{{ service._id }}"
            class="carousel slide"
            data-bs-ride="carousel"
          >
            <div class="carousel-inner">
              <div
                *ngFor="let image of service.productImages; let i = index"
                class="carousel-item"
                [ngClass]="{ active: i === 0 }"
              >
                <!-- Display the image from the server -->
                <img
                  [src]="getFullImagePath(image)"
                  class="d-block w-100"
                  alt="Service Image"
                  style="height: 200px; object-fit: cover"
                />
              </div>
  
              <!-- Fallback if no images are available -->
              <div
                *ngIf="service.productImages.length === 0"
                class="carousel-item active"
              >
                <div
                  class="d-flex justify-content-center align-items-center bg-secondary"
                  style="height: 200px"
                >
                  <p class="text-white">No Image Available</p>
                </div>
              </div>
            </div>
  
            <!-- Carousel Controls (next and previous buttons) -->
            <button
              class="carousel-control-prev"
              type="button"
              [attr.data-bs-target]="'#carousel' + service._id"
              data-bs-slide="prev"
            >
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Previous</span>
            </button>
            <button
              class="carousel-control-next"
              type="button"
              [attr.data-bs-target]="'#carousel' + service._id"
              data-bs-slide="next"
            >
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Next</span>
            </button>
          </div>
  
          <!-- Card Body for Service Details -->
          <div class="card-body">
            <h5 class="card-title">{{ service.productName }}</h5>
            <p class="card-text">{{ service.productDescription }}</p>
            <p><strong>Category:</strong> {{ service.productCategory }}</p>
            <div *ngIf="service.productSubcategory?.length > 0">
              <p><strong>Vehicle Avalaible: </strong> {{ getUniqueSubcategories(service) }}</p>
            </div>
            <div class="rating">
              <ng-container *ngIf="service.averageRating > 0; else noRating">
                <!-- Full Stars -->
                <i *ngFor="let _ of [].constructor(Math.floor(service.averageRating))" class="fas fa-star star"></i>
            
                <!-- Half Star (only one if rating has a half part) -->
                <i *ngIf="service.averageRating % 1 >= 0.5" class="fas fa-star-half-alt star"></i>
            
                <!-- Empty Stars (always ensures 5 stars are displayed) -->
                <i *ngFor="let _ of [].constructor(5 - Math.floor(service.averageRating) - (service.averageRating % 1 >= 0.5 ? 1 : 0))" class="far fa-star star"></i>
            
                <!-- Display Average Rating and Review Count in Format "4.3 (15)" -->
                <span>{{ service.averageRating | number: '1.1-1' }} ({{ service.reviewCount }})</span>
              </ng-container>
            
              <!-- Fallback message if there is no rating -->
              <ng-template #noRating>
                <span class="text-muted">No ratings yet</span>
              </ng-template>
            </div>
            
            
      
            <p>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  